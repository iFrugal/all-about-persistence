# Valid MongoDB query file for testing - Users collection
queries:
  findAll:
    readerId: mongodb
    rawFormat: YAML
    raw: |-
      {
        "collectionName": "users",
        "operation": "FIND",
        "filter": {}
      }

  findById:
    readerId: mongodb
    rawFormat: YAML
    raw: |-
      {
        "collectionName": "users",
        "operation": "FIND",
        "filter": {"_id": "${params.id}"}
      }
    params:
      id:
        typeFqcn: "java.lang.String"
        required: true

  search:
    readerId: mongodb
    rawFormat: YAML
    raw: |-
      {
        "collectionName": "users",
        "operation": "FIND",
        "filter": {
          <#if params.name??>
          "name": {"$regex": "${params.name}", "$options": "i"}
          </#if>
          <#if params.status??>
          <#if params.name??>,</#if>
          "status": "${params.status}"
          </#if>
        },
        "sort": {"createdAt": -1}
      }
    params:
      name:
        typeFqcn: "java.lang.String"
        required: false
      status:
        typeFqcn: "java.lang.String"
        required: false

  aggregateByStatus:
    readerId: mongodb
    rawFormat: YAML
    raw: |-
      {
        "collectionName": "users",
        "operation": "AGGREGATE",
        "pipeline": [
          {"$match": {"status": {"$in": ["ACTIVE", "PENDING"]}}},
          {"$group": {"_id": "$status", "count": {"$sum": 1}}},
          {"$sort": {"count": -1}}
        ]
      }
